/*! taboverride v3.2.0pre | https://github.com/wjbryant/taboverride
Copyright (c) 2012 Bill Bryant | http://opensource.org/licenses/mit */
(function(e){"use strict";function t(){var t=window.TABOVERRIDE=e();return t}typeof define=="function"&&define.amd?define("taboverride",[],t):t()})(function(){"use strict";function d(e,t){var n=["alt","ctrl","meta","shift"],r,i,s=!0;for(r=0;r<n.length;r+=1){i=n[r]+"Key";if(i!==e&&t[i]){s=!1;break}}return s}function v(e,t){return e===s&&(!u||t[u])}function m(e,t){return e===o&&(!a||t[a])}var e={},t=window.document,n,r,i="	",s=9,o=9,u="",a="shiftKey",f=!1,l=!1,c=t.createElement("textarea"),h,p;return e.overrideKeyDown=function(e){e=e||event;var n=e.currentTarget||e.srcElement,r=e.keyCode,c,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P="character";if(n.nodeName&&n.nodeName.toLowerCase()!=="textarea"||r!==s&&r!==o&&(r!==13||!f))return;l=!1,y=n.value,x=n.scrollTop;if(typeof n.selectionStart=="number")T=n.selectionStart,N=n.selectionEnd,C=y.slice(T,N);else{if(!t.selection)return;b=t.selection.createRange(),C=b.text,w=b.duplicate(),w.moveToElementText(n),w.setEndPoint("EndToEnd",b),N=w.text.length,T=N-C.length,p>1?(E=y.slice(0,T).split(h).length-1,S=C.split(h).length-1):E=S=0}if(r===s||r===o){c=i,g=c.length,A=0,O=0,M=0;if(T!==N&&C.indexOf("\n")!==-1){T===0||y.charAt(T-1)==="\n"?k=T:k=y.lastIndexOf("\n",T-1)+1,N===y.length||y.charAt(N)==="\n"?L=N:(L=y.indexOf("\n",N),L===-1&&(L=y.length));if(m(r,e)){if(!d(a,e))return;y.slice(k).indexOf(c)===0&&(k===T?C=C.slice(g):M=g,O=g),n.value=y.slice(0,k)+y.slice(k+M,T)+C.replace(new RegExp("\n"+c,"g"),function(){return A+=1,"\n"})+y.slice(N),b?(b.collapse(),b.moveEnd(P,N-O-A*g-S-E),b.moveStart(P,T-M-E),b.select()):(n.selectionStart=T-M,n.selectionEnd=N-O-A*g)}else if(v(r,e)){if(!d(u,e))return;A=1,n.value=y.slice(0,k)+c+y.slice(k,T)+C.replace(/\n/g,function(){return A+=1,"\n"+c})+y.slice(N),b?(b.collapse(),b.moveEnd(P,N+A*g-S-E),b.moveStart(P,T+g-E),b.select()):(n.selectionStart=T+g,n.selectionEnd=N+A*g,n.scrollTop=x)}}else if(m(r,e)){if(!d(a,e))return;y.slice(T-g).indexOf(c)===0&&(n.value=y.slice(0,T-g)+y.slice(T),b?(b.move(P,T-g-E),b.select()):(n.selectionEnd=n.selectionStart=T-g,n.scrollTop=x))}else if(v(r,e)){if(!d(u,e))return;b?(b.text=c,b.select()):(n.value=y.slice(0,T)+c+y.slice(N),n.selectionEnd=n.selectionStart=T+g,n.scrollTop=x)}}else if(f){if(T===0||y.charAt(T-1)==="\n"){l=!0;return}k=y.lastIndexOf("\n",T-1)+1,L=y.indexOf("\n",T),L===-1&&(L=y.length),_=y.slice(k,L).match(/^[ \t]*/)[0],D=_.length;if(T<k+D){l=!0;return}b?(b.text="\n"+_,b.select()):(n.value=y.slice(0,T)+"\n"+_+y.slice(N),n.selectionEnd=n.selectionStart=T+p+D,n.scrollTop=x)}if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()},e.overrideKeyPress=function(e){e=e||event;var t=e.keyCode;if(v(t,e)&&d(u,e)||m(t,e)&&d(a,e)||t===13&&f&&!l){if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t.addEventListener?(n=function(t){r(t),t.addEventListener("keydown",e.overrideKeyDown,!1),t.addEventListener("keypress",e.overrideKeyPress,!1)},r=function(t){t.removeEventListener("keydown",e.overrideKeyDown,!1),t.removeEventListener("keypress",e.overrideKeyPress,!1)}):t.attachEvent?(n=function(t){r(t),t.attachEvent("onkeydown",e.overrideKeyDown),t.attachEvent("onkeypress",e.overrideKeyPress)},r=function(t){t.detachEvent("onkeydown",e.overrideKeyDown),t.detachEvent("onkeypress",e.overrideKeyPress)}):n=r=function(){},e.set=function(e,t){var i,s,o,u,a;if(e){i=arguments.length<2||t?n:r,u=e,o=u.length,typeof o!="number"&&(u=[u],o=1);for(s=0;s<o;s+=1)a=u[s],a&&a.nodeName&&a.nodeName.toLowerCase()==="textarea"&&i(a)}return this},e.tabSize=function(e){var t;if(arguments.length){if(!e)i="	";else if(typeof e=="number"&&e>0){i="";for(t=0;t<e;t+=1)i+=" "}return this}return i==="	"?0:i.length},e.autoIndent=function(e){return arguments.length?(f=e?!0:!1,this):f},e.tabKey=function(e,t){return arguments.length?(s=e,u=t?t+"Key":"",this):(u?u.slice(0,-3)+"+":"")+s},e.untabKey=function(e,t){return arguments.length?(o=e,a=t?t+"Key":"",this):(a?a.slice(0,-3)+"+":"")+o},c.value="\n",h=c.value,p=h.length,c=null,e});
